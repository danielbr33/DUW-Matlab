function F=Fi(q,t,ParyObrotowe, ParyPostepowe);

 temp = fopen('Dane/ParyObrotowe.txt', 'r');
 nobr = str2num(fgetl(temp));
 
 temp = fopen('Dane/ParyPostepowe.txt', 'r');
 npos = str2num(fgetl(temp));
 
 k=0                         %licznik rÃ³wnaÅ„ wiÄ™zÃ³w
 F=zeros(2*(nobr+npos),1)    %deklaracja rozmiaru wektora
    
 %%na podstawie wzoru 2.18
 for m=1:nobr
        i=3*ParyObrotowe(m,1);
        j=3*ParyObrotowe(m,2);
        s_a = ParyObrotowe(m,3:4);
        s_b = ParyObrotowe(m,3:4);
        if i == 0
            F(k+1:k+2,1)=s_a - q(j-2:j-1,1)-Rot(q(j))*s_b;
        elseif j == 0
            F(k+1:k+2,1)=q(i-2:i-1,1)+Rot(q(i))*s_a-s_b;
        else
            F(k+1:k+2,1)=q(i-2:i-1,1)+Rot(q(i))*s_a-q(j-2:j-1,1)-Rot(q(j))*s_b;
        end
        k=k+2;
 end
 
 %% Na podstawie wzorów 2.19 i 2.22
 %NIE WIEM CO ROBIÄ? I CZY TO JEST DOBRZE - NIEKSONCZONE - problemy z: fi0
 %oraz vj
 %+ czy trzeba tu rozwaÅ¼aÄ‡ te przypadki if else?
 for m=1:npos
     i=3*ParyPostepowe(m,1);
     j=3*ParyPostepowe(m,2);
     fi0 = ParyPostepowe(m,3);
     s_b = ParyPostepowe(m,8:9)
     s_a = ParyPostepowe(m,6:7)
     vj = ParyPostepowe(m,4:5)
     rj = q(j-2:j-1,1);
     ri = q(i-2:i-1,1);;
     kat_i = q(i)
     kat_j = q(j);
        
     F(k+1,1)=kat_i-kat_j-fi0; 
     F(k+2,1)=(rj+Rot(q(j))*s_b-ri-Rot(q(i))*s_a)'*Rot(q(j))*vj;
     
     k=k+2;
 end
      